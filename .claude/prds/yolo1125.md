---
name: yolo1125
description: 結合 YOLO 物品辨識與人臉識別的智慧無人商店結帳系統
status: backlog
created: 2025-10-30T03:25:19Z
---

# PRD: yolo1125 - 智慧無人商店結帳系統

## Executive Summary

yolo1125 是一個整合 YOLO 物品辨識與人臉識別技術的智慧結帳系統，專為無人商店場景設計。系統透過電腦鏡頭自動識別顧客身份並掃描商品，提供無接觸、高效率的購物結帳體驗。

**核心價值**：
- 無需人工收銀，降低人力成本
- 快速身份驗證與商品識別
- 完整交易記錄追蹤
- 提升購物體驗與效率

## Problem Statement

### 現有問題
1. **傳統收銀流程耗時**：需要人工掃描商品條碼、處理支付
2. **人力成本高昂**：小型商店需要配置收銀人員
3. **疫情後非接觸需求**：減少人與人接觸的支付方式需求增加
4. **商品管理困難**：缺乏自動化的銷售追蹤系統

### 為什麼現在重要
- 已完成 YOLO 物品辨識模型訓練（元翠茶、分解茶）
- 具備技術基礎可快速實現商用系統
- 無人商店市場需求持續成長
- 可作為概念驗證擴展至其他商品類別

## User Stories

### 主要使用者角色

**1. 新顧客（首次使用者）**
```
作為一個新顧客
我想要快速註冊並開始購物
以便我能立即使用無人商店服務
```

**使用流程**：
1. 站在鏡頭前
2. 系統偵測到新人臉
3. 輸入姓名和電話號碼
4. 系統儲存人臉特徵和個人資料
5. 自動登入並開始購物

**接受標準**：
- 人臉註冊時間 < 10 秒
- 註冊表單僅需姓名和電話兩個欄位
- 成功儲存人臉圖片和特徵向量

---

**2. 回訪顧客（已註冊使用者）**
```
作為一個回訪顧客
我想要系統自動識別我的身份
以便我能快速開始購物而無需重複註冊
```

**使用流程**：
1. 站在鏡頭前
2. 系統自動識別人臉
3. 顯示個人資料（姓名、電話）
4. 開始掃描商品

**接受標準**：
- 人臉識別回應時間 < 2 秒
- 識別準確率在合理範圍內
- 正確顯示使用者資料

---

**3. 購物顧客**
```
作為一個正在購物的顧客
我想要將商品展示給鏡頭並自動加入購物車
以便我能快速完成商品選購
```

**使用流程**：
1. 登入後進入購物模式
2. 將商品（茶葉）展示給鏡頭
3. 系統識別商品類別並加入購物清單
4. 右側即時顯示：
   - 已掃描商品列表
   - 每項商品數量和單價
   - 右下角顯示總數量和總價
5. 如需移除商品，點擊「移除」按鈕
6. 確認無誤後點擊「完成結帳」

**接受標準**：
- 商品識別回應時間 < 1 秒
- 同一商品掃描多次自動累加數量
- 即時更新購物車和總價
- 支援商品移除功能
- 清楚顯示每項商品名稱、單價、數量

---

**4. 系統管理員**
```
作為系統管理員
我想要能夠管理商品資料和查看交易記錄
以便我能維護商品資訊和分析銷售數據
```

**需求**：
- 新增/編輯/刪除商品資訊（名稱、價格、YOLO 類別 ID）
- 查看交易記錄
- 查看使用者資料
- 查看系統運行狀態

## Requirements

### Functional Requirements

#### FR1: 人臉識別模組
- **FR1.1** 系統啟動時自動開啟電腦鏡頭
- **FR1.2** 即時偵測畫面中的人臉
- **FR1.3** 首次偵測到新人臉時，提示使用者輸入姓名和電話
- **FR1.4** 儲存人臉圖片（原始照片）和人臉特徵向量至 MongoDB
- **FR1.5** 已註冊使用者自動比對人臉並登入系統
- **FR1.6** 登入後在介面左側顯示使用者個人資料

#### FR2: 商品辨識模組
- **FR2.1** 登入後啟用 YOLO 物品辨識功能
- **FR2.2** 即時偵測鏡頭畫面中的商品（元翠茶、分解茶）
- **FR2.3** 識別到商品時自動加入購物清單
- **FR2.4** 同一商品多次掃描自動累加數量
- **FR2.5** 即時更新購物車資訊：商品名稱、單價、數量、小計

#### FR3: 購物車管理
- **FR3.1** 右側顯示購物車介面，列出所有已掃描商品
- **FR3.2** 每項商品顯示：名稱、單價、數量、小計
- **FR3.3** 提供「移除」按鈕可刪除單項商品
- **FR3.4** 右下角顯示總數量和總價格
- **FR3.5** 購物車資料即時更新

#### FR4: 結帳流程
- **FR4.1** 提供「完成結帳」按鈕
- **FR4.2** 點擊後儲存交易記錄至 MongoDB
- **FR4.3** 交易記錄包含：
  - 使用者 ID
  - 購買時間
  - 商品清單（名稱、數量、單價、小計）
  - 總金額
- **FR4.4** 結帳完成後清空購物車
- **FR4.5** 顯示結帳成功訊息

#### FR5: 商品資料庫管理
- **FR5.1** MongoDB 儲存商品資訊：
  - 商品 ID
  - 商品名稱
  - 商品價格
  - YOLO 類別 ID（對應訓練模型的類別）
  - 商品圖片（選填）
- **FR5.2** 初始資料包含：元翠茶、分解茶
- **FR5.3** 支援未來新增其他商品

#### FR6: 使用者介面
- **FR6.1** 使用 HTML 開發網頁介面
- **FR6.2** 介面佈局：
  - 中央：鏡頭即時畫面（顯示偵測框和標籤）
  - 左側：使用者個人資料（登入後顯示）
  - 右側：購物車清單
  - 右下：總數量和總價
  - 底部：「完成結帳」和「移除商品」按鈕
- **FR6.3** 響應式設計，適配不同螢幕尺寸
- **FR6.4** 即時更新，無需手動刷新

### Non-Functional Requirements

#### NFR1: 效能
- **NFR1.1** 人臉識別回應時間：< 2 秒
- **NFR1.2** 商品辨識回應時間：< 1 秒
- **NFR1.3** 人臉註冊流程：< 10 秒
- **NFR1.4** 畫面更新延遲：< 100ms

#### NFR2: 準確度
- **NFR2.1** 人臉識別準確率：在合理正常範圍內（> 90%）
- **NFR2.2** 商品辨識準確率：基於已訓練 YOLO 模型的表現
- **NFR2.3** 誤識別處理：允許使用者手動移除錯誤商品

#### NFR3: 可用性
- **NFR3.1** 介面操作簡單直覺，無需使用說明
- **NFR3.2** 提供清楚的視覺回饋（偵測框、標籤、提示訊息）
- **NFR3.3** 單人操作，無需排隊功能

#### NFR4: 安全性
- **NFR4.1** 人臉圖片和特徵向量安全儲存
- **NFR4.2** 交易記錄完整保存，不可竄改
- **NFR4.3** 使用者資料符合基本隱私保護

#### NFR5: 可維護性
- **NFR5.1** 程式碼結構清晰，模組化設計
- **NFR5.2** 商品資料庫易於擴充新商品
- **NFR5.3** YOLO 模型可獨立更新

#### NFR6: 部署環境
- **NFR6.1** 本地端運行（不需雲端部署）
- **NFR6.2** 使用本機電腦鏡頭
- **NFR6.3** MongoDB 資料庫本地安裝

## Success Criteria

### 關鍵指標 (KPIs)

1. **功能完整性**
   - ✅ 人臉註冊和識別功能正常運作
   - ✅ 商品掃描和購物車管理正常運作
   - ✅ 結帳流程和資料儲存正常運作

2. **效能指標**
   - 人臉識別成功率 > 90%
   - 商品識別成功率基於 YOLO 模型表現
   - 系統回應時間符合 NFR 要求

3. **使用者體驗**
   - 首次使用者能在 2 分鐘內完成註冊和首次購物
   - 回訪使用者能在 30 秒內完成身份驗證和購物
   - 介面操作無需額外說明

4. **資料完整性**
   - 所有交易記錄正確儲存至資料庫
   - 使用者資料和人臉特徵完整保存
   - 無資料遺失或損壞

5. **系統穩定性**
   - 連續運行 8 小時無崩潰
   - 處理 100 筆交易無錯誤
   - 鏡頭畫面流暢無卡頓

## Technical Architecture

### 系統架構圖

```
┌─────────────────────────────────────────────────────────┐
│                    前端 (HTML/JS)                        │
│  ��──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │  鏡頭畫面    │  │ 使用者資料   │  │   購物車     │  │
│  │  (Canvas)    │  │  顯示區      │  │   清單       │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
│         │                  │                  │          │
│         └──────────────────┼──────────────────┘          │
│                            │                             │
│                     WebSocket / HTTP API                 │
│                            │                             │
└────────────────────────────┼─────────────────────────────┘
                             │
┌────────────────────────────┼─────────────────────────────┐
│                    後端 (Python)                          │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │  Flask/       │  │   人臉識別   │  │  YOLO 物品   │  │
│  │  FastAPI      │◄─┤   模組       │  │  辨識模組    │  │
│  │  Web Server   │  │ (face_recog) │  │ (已訓練模型) │  │
│  └───────┬───────┘  └──────────────┘  └──────────────┘  │
│          │                                                │
│          │          ┌──────────────┐                     │
│          └─────────►│  業務邏輯    │                     │
│                     │  - 購物車    │                     │
│                     │  - 結帳      │                     │
│                     └───────┬──────┘                     │
│                             │                             │
└─────────────────────────────┼─────────────────────────────┘
                              │
                     MongoDB Connection
                              │
┌─────────────────────────────┼─────────────────────────────┐
│                      MongoDB 資料庫                        │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │   Users      │  │   Products   │  │ Transactions │  │
│  │  Collection  │  │  Collection  │  │  Collection  │  │
│  │- 姓名        │  │- 商品名稱    │  │- 使用者 ID   │  │
│  │- 電話        │  │- 價格        │  │- 商品清單    │  │
│  │- 人臉特徵    │  │- YOLO ID     │  │- 總金額      │  │
│  │- 人臉圖片    │  │- 圖片        │  │- 時間        │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
└─────────────────────────────────────────────────────────┘
```

### 技術堆疊

**前端**：
- HTML5, CSS3, JavaScript
- Canvas API（顯示鏡頭畫面和偵測框）
- WebRTC / getUserMedia（鏡頭存取）

**後端**：
- Python 3.8+
- Web 框架：Flask 或 FastAPI
- YOLO：Ultralytics YOLOv8（已訓練模型）
- 人臉識別：face_recognition 或 OpenCV + dlib
- 影像處理：OpenCV, PIL

**資料庫**：
- MongoDB 6.0+
- PyMongo（Python driver）

**部署**：
- 本地端運行
- 開發模式（無需 HTTPS、域名）

## Data Models

### MongoDB Collections

#### 1. Users Collection
```json
{
  "_id": ObjectId,
  "name": "String",           // 姓名
  "phone": "String",          // 電話
  "face_encoding": [Float],   // 人臉特徵向量 (128-d or 512-d)
  "face_image": "String",     // Base64 編碼的人臉圖片或檔案路徑
  "created_at": ISODate,      // 註冊時間
  "last_visit": ISODate       // 最後使用時間
}
```

#### 2. Products Collection
```json
{
  "_id": ObjectId,
  "name": "String",           // 商品名稱（元翠茶、分解茶）
  "price": Number,            // 價格
  "yolo_class_id": Int,       // YOLO 模型的類別 ID
  "yolo_class_name": "String",// YOLO 類別名稱
  "image": "String",          // 商品圖片（選填）
  "created_at": ISODate
}
```

#### 3. Transactions Collection
```json
{
  "_id": ObjectId,
  "user_id": ObjectId,        // 關聯 Users._id
  "user_name": "String",      // 使用者姓名（冗餘儲存）
  "items": [                  // 購買商品清單
    {
      "product_id": ObjectId, // 關聯 Products._id
      "product_name": "String",
      "quantity": Int,
      "unit_price": Number,
      "subtotal": Number
    }
  ],
  "total_quantity": Int,      // 總數量
  "total_amount": Number,     // 總金額
  "created_at": ISODate       // 交易時間
}
```

## User Interface Design

### 介面佈局

```
┌─────────────────────────────────────────────────────────────┐
│                      智慧無人商店系統                         │
├─────────────┬───────────────────────────┬───────────────────┤
│             │                           │                   │
│  使用者資料  │      鏡頭即時畫面          │    購物車清單      │
│             │    (顯示偵測框和標籤)      │                   │
│  [頭像]     │                           │  ┌──────────────┐ │
│  姓名：XXX  │         [Canvas]          │  │元翠茶  x2    │ │
│  電話：XXX  │                           │  │NT$ 150 x2    │ │
│             │                           │  │= NT$ 300     │ │
│             │                           │  ├──────────────┤ │
│             │                           │  │分解茶  x1    │ │
│             │                           │  │NT$ 200 x1    │ │
│             │                           │  │= NT$ 200     │ │
│             │                           │  └──────────────┘ │
│             │                           │  [移除] [移除]    │
│             │                           │                   │
│             │                           │  ┌──────────────┐ │
│             │                           │  │ 總數量: 3    │ │
│             │                           │  │ 總價: NT$500 │ │
│             │                           │  └──────────────┘ │
├─────────────┴───────────────────────────┴───────────────────┤
│                       [完成結帳]                             │
└─────────────────────────────────────────────────────────────┘
```

### 互動流程

**首次使用者（註冊）**：
1. 鏡頭畫面出現人臉偵測框
2. 彈出註冊表單（姓名、電話）
3. 提交後顯示「註冊成功」
4. 左側顯示使用者資料
5. 進入購物模式

**回訪使用者（自動登入）**：
1. 鏡頭偵測到人臉
2. 自動比對並識別
3. 左側顯示「歡迎回來，XXX」
4. 直接進入購物模式

**購物流程**：
1. 展示商品給鏡頭
2. YOLO 偵測並顯示商品名稱（綠色框）
3. 商品自動加入右側購物車
4. 總價即時更新
5. 重複掃描則數量 +1
6. 點擊「移除」可刪除商品
7. 確認後點擊「完成結帳」
8. 顯示「結帳成功」訊息
9. 購物車清空，等待下一位使用者

## Constraints & Assumptions

### 技術限制
1. **單鏡頭限制**：系統僅支援單一電腦鏡頭，無法同時處理多角度
2. **單人使用**：無排隊或多人同時使用功能
3. **光線條件**：人臉和商品辨識需要足夠光線
4. **商品類別**：初期僅支援 2 種茶葉（元翠、分解），需逐步擴充
5. **本地運行**：限本機環境，無遠端存取

### 業務假設
1. **使用環境**：室內無人商店，有穩定照明
2. **商品展示**：使用者會主動將商品展示給鏡頭
3. **誠實使用**：假設使用者不會刻意欺騙系統（例如遮擋商品）
4. **網路穩定**：本地網路穩定（MongoDB 連線）
5. **硬體效能**：電腦具備基本運算能力（CPU 或有 GPU 更佳）

### 資源限制
1. **開發時程**：待定（需與開發團隊討論）
2. **開發人力**：待定
3. **硬體成本**：使用現有電腦和鏡頭，無需額外採購
4. **商品資料**：初期商品數量有限，價格需手動維護

### 法規與合規
1. **隱私權**：人臉圖片和個人資料儲存需符合個資法
2. **肖像權**：需使用者同意拍攝和儲存人臉
3. **消費者保護**：交易記錄需保存以供查詢

## Out of Scope

以下功能明確**不在此 PRD 範圍內**，未來版本可考慮：

### V1.0 不包含的功能

1. **支付整合**
   - 信用卡、行動支付串接
   - 金流處理
   - 發票開立

2. **多人支援**
   - 排隊系統
   - 多人同時購物
   - 人臉切換偵測

3. **進階商品管理**
   - 商品庫存追蹤
   - 自動補貨提醒
   - 商品分類和搜尋

4. **會員系統**
   - 會員等級和點數
   - 優惠券和折扣
   - 購物歷史查詢（使用者端）

5. **進階安全功能**
   - 活體辨識（防止照片攻擊）
   - 多重身份驗證
   - 異常行為偵測

6. **管理後台**
   - 商品管理介面
   - 交易報表和分析
   - 使用者管理

7. **雲端部署**
   - 遠端存取
   - 多店鋪支援
   - 集中式資料管理

8. **行動裝置支援**
   - 手機 App
   - 平板介面
   - QR Code 掃描

9. **進階 AI 功能**
   - 商品推薦
   - 異常交易偵測
   - 客流量分析

10. **多語言支援**
    - 初版僅繁體中文

## Dependencies

### 外部依賴

#### 技術依賴
1. **YOLO 模型**
   - 已完成訓練的 YOLOv8 模型
   - 商品類別：元翠茶、分解茶
   - 模型檔案位置和載入方式

2. **Python 套件**
   - ultralytics (YOLOv8)
   - face_recognition 或 OpenCV + dlib
   - Flask 或 FastAPI
   - pymongo
   - opencv-python
   - numpy, pillow

3. **硬體設備**
   - 電腦（支援 Python 執行）
   - USB 或內建鏡頭
   - 足夠的 RAM（建議 8GB+）
   - 儲存空間（MongoDB 資料）

4. **軟體環境**
   - Python 3.8+
   - MongoDB 6.0+（本地安裝）
   - 現代瀏覽器（Chrome, Edge, Firefox）

#### 資料依賴
1. **商品資料**
   - 元翠茶價格
   - 分解茶價格
   - 商品圖片（選填）

2. **YOLO 模型配置**
   - 類別 ID 對應商品名稱
   - 模型權重檔案路徑
   - 信心度閾值設定

### 內部依賴

#### 開發順序依賴
1. **Phase 1：基礎架構**（無依賴）
   - MongoDB 資料庫設計和建立
   - 基本 Web 框架搭建
   - 鏡頭存取功能

2. **Phase 2：人臉識別**（依賴 Phase 1）
   - 人臉偵測和註冊
   - 人臉比對和登入
   - 使用者資料儲存

3. **Phase 3：商品辨識**（依賴 Phase 1）
   - YOLO 模型整合
   - 商品偵測和識別
   - 商品資料庫查詢

4. **Phase 4：購物車和結帳**（依賴 Phase 2, 3）
   - 購物車邏輯
   - 結帳流程
   - 交易記錄儲存

5. **Phase 5：前端整合**（依賴 Phase 2, 3, 4）
   - 完整 UI 實作
   - 前後端串接
   - 即時更新功能

#### 跨模組依賴
```
MongoDB 資料庫
    ↓
    ├─→ 使用者管理模組
    │       ↓
    │   人臉識別模組
    │       ↓
    ├─→ 商品管理模組
    │       ↓
    │   YOLO 辨識模組
    │       ↓
    └─→ 購物車模組 ←─┐
            ↓         │
        結帳模組      │
            ↓         │
        交易記錄 ─────┘
```

### 風險依賴
1. **YOLO 模型表現**：商品辨識準確度直接影響使用者體驗
2. **人臉識別準確度**：光線條件影響識別成功率
3. **鏡頭品質**：低品質鏡頭可能影響辨識效果
4. **MongoDB 效能**：大量交易記錄可能需要索引優化

## Implementation Roadmap

### Phase 1: 基礎架構建置（Week 1）
- [ ] 建立專案結構和版本控制
- [ ] 安裝和設定 MongoDB
- [ ] 建立 MongoDB Collections（Users, Products, Transactions）
- [ ] 建立基本 Web 框架（Flask/FastAPI）
- [ ] 實作鏡頭存取功能（WebRTC）
- [ ] 建立基本 HTML 介面框架

**驗收標準**：
- MongoDB 可正常連線
- 網頁能顯示鏡頭畫面
- 專案架構清晰可擴充

---

### Phase 2: 人臉識別功能（Week 2）
- [ ] 整合人臉識別套件（face_recognition 或 OpenCV）
- [ ] 實作人臉偵測功能
- [ ] 實作新使用者註冊流程
  - [ ] 註冊表單（姓名、電話）
  - [ ] 人臉特徵提取和儲存
  - [ ] 人臉圖片儲存
- [ ] 實作人臉比對和自動登入
- [ ] 使用者資料顯示（左側面板）

**驗收標準**：
- 新使用者能成功註冊
- 回訪使用者自動識別並登入
- 使用者資料正確顯示

---

### Phase 3: 商品辨識功能（Week 2-3）
- [ ] 載入已訓練的 YOLO 模型
- [ ] 實作即時商品偵測
- [ ] 建立 Products Collection 初始資料
  - [ ] 元翠茶（名稱、價格、YOLO ID）
  - [ ] 分解茶（名稱、價格、YOLO ID）
- [ ] 商品識別結果處理
- [ ] 在鏡頭畫面顯示偵測框和標籤

**驗收標準**：
- YOLO 模型成功載入
- 能即時偵測元翠茶和分解茶
- 偵測結果顯示在畫面上

---

### Phase 4: 購物車和結帳（Week 3-4）
- [ ] 實作購物車邏輯
  - [ ] 商品加入購物車
  - [ ] 數量自動累加
  - [ ] 商品移除功能
  - [ ] 總價計算
- [ ] 購物車 UI（右側面板）
  - [ ] 商品清單顯示
  - [ ] 總數量和總價顯示
  - [ ] 移除按鈕
- [ ] 結帳流程
  - [ ] 「完成結帳」按鈕
  - [ ] 交易記錄儲存
  - [ ] 結帳成功提示
  - [ ] 購物車清空

**驗收標準**：
- 購物車功能完整運作
- 結帳流程順暢
- 交易記錄正確儲存至 MongoDB

---

### Phase 5: 前端整合和優化（Week 4）
- [ ] 完整 UI 整合
  - [ ] 三欄式佈局（使用者、鏡頭、購物車）
  - [ ] 響應式設計
  - [ ] 視覺效果優化
- [ ] 前後端即時通訊
  - [ ] WebSocket 或輪詢機制
  - [ ] 即時更新購物車
- [ ] 使用者體驗優化
  - [ ] 載入動畫
  - [ ] 錯誤提示
  - [ ] 成功訊息

**驗收標準**：
- 介面美觀且易用
- 所有功能流暢運作
- 即時更新無延遲

---

### Phase 6: 測試和除錯（Week 5）
- [ ] 功能測試
  - [ ] 人臉註冊和識別
  - [ ] 商品辨識
  - [ ] 購物車操作
  - [ ] 結帳流程
- [ ] 效能測試
  - [ ] 回應時間測量
  - [ ] 長時間運行穩定性
- [ ] 邊界測試
  - [ ] 無人臉情況
  - [ ] 無商品情況
  - [ ] 網路中斷處理
- [ ] Bug 修復和優化

**驗收標準**：
- 所有核心功能通過測試
- 效能符合 NFR 要求
- 無重大 Bug

---

### Phase 7: 文件和交付（Week 5-6）
- [ ] 使用者操作手冊
- [ ] 系統安裝和部署文件
- [ ] API 文件（如需要）
- [ ] 程式碼註解和文件
- [ ] 商品資料維護說明

**交付內容**：
- 完整程式碼
- MongoDB 初始化腳本
- 安裝和部署指南
- 使用者手冊
- 測試報告

## Risks and Mitigation

### 技術風險

**風險 1：人臉識別準確度不足**
- **影響**：使用者無法順利登入，影響體驗
- **機率**：中
- **緩解策略**：
  - 使用成熟的人臉識別庫（face_recognition）
  - 設定合理的相似度閾值
  - 提供手動重試機制
  - 確保環境光線充足
  - 如仍失敗，允許手動輸入電話查詢

**風險 2：YOLO 商品辨識誤判**
- **影響**：錯誤商品加入購物車，需手動移除
- **機率**：中
- **緩解策略**：
  - 設定適當的信心度閾值（> 0.7）
  - 提供明顯的移除按鈕
  - 在畫面上清楚顯示偵測結果
  - 需要時可重新訓練模型

**風險 3：鏡頭存取問題**
- **影響**：系統無法啟動
- **機率**：低
- **緩解策略**：
  - 檢查瀏覽器權限設定
  - 提供清楚的錯誤訊息和解決步驟
  - 支援多種瀏覽器
  - 測試多種鏡頭設備

**風險 4：MongoDB 連線失敗**
- **影響**：無法儲存資料，系統無法使用
- **機率**：低
- **緩解策略**：
  - 啟動時檢查 MongoDB 連線
  - 提供清楚的錯誤訊息
  - 自動重新連線機制
  - 緊急情況使用本地快取

### 業務風險

**風險 5：使用者不信任人臉識別**
- **影響**：使用者拒絕使用系統
- **機率**：低
- **緩解策略**：
  - 提供清楚的隱私權說明
  - 說明人臉資料僅用於身份驗證
  - 提供資料刪除選項（未來功能）

**風險 6：商品數量不足，實用性低**
- **影響**：系統無法滿足實際需求
- **機率**：中
- **緩解策略**：
  - 設計易於擴充的商品資料庫
  - 提供商品新增流程文件
  - 規劃未來商品擴充計畫

### 專案風險

**風險 7：開發時程延遲**
- **影響**：無法如期交付
- **機率**：中
- **緩解策略**：
  - 分階段開發，優先核心功能
  - 定期檢視進度
  - 預留緩衝時間

**風險 8：硬體效能不足**
- **影響**：系統卡頓，使用者體驗差
- **機率**：低
- **緩解策略**：
  - 提前測試硬體效能
  - 優化模型推論速度
  - 降低影像解析度（如需要）
  - 建議最低硬體規格

## Questions and Open Issues

### 待確認問題

1. **支付流程**：結帳後如何收款？
   - 選項 A：串接金流（超出 V1.0 範圍）
   - 選項 B：顯示總金額，使用者自行支付（現金、轉帳）
   - 選項 C：僅記錄交易，後續人工對帳

2. **商品價格**：
   - 元翠茶和分解茶的實際價格？
   - 價格單位（元、包、罐）？

3. **人臉圖片儲存格式**：
   - 原始照片尺寸？
   - Base64 或檔案路徑？
   - 儲存位置（MongoDB GridFS 或本地資料夾）？

4. **開發環境**：
   - Windows / macOS / Linux？
   - 是否有 GPU 可用？
   - Python 版本限制？

5. **未來擴充**：
   - 預計多久會新增商品？
   - 商品數量上限？
   - 是否需要管理後台？

### 技術決策待定

1. **Web 框架選擇**：Flask vs FastAPI
   - Flask：簡單、穩定、生態系成熟
   - FastAPI：現代、效能佳、內建 WebSocket

2. **人臉識別套件**：face_recognition vs OpenCV + dlib
   - face_recognition：簡單易用、準確度高
   - OpenCV + dlib：可客製化、效能更好

3. **前端框架**：純 HTML/JS vs 輕量框架
   - 純 HTML/JS：簡單、無學習曲線
   - Vue/React：更好的狀態管理，但增加複雜度

4. **即時通訊方式**：WebSocket vs HTTP 輪詢
   - WebSocket：即時性佳、雙向通訊
   - HTTP 輪詢：簡單、相容性好

## Appendix

### 參考資料

1. **YOLO 相關**
   - Ultralytics YOLOv8 文件：https://docs.ultralytics.com/
   - 已訓練模型位置：[待確認]

2. **人臉識別**
   - face_recognition 文件：https://face-recognition.readthedocs.io/
   - OpenCV 人臉識別教學：https://docs.opencv.org/

3. **MongoDB**
   - PyMongo 文件：https://pymongo.readthedocs.io/
   - MongoDB 官方文件：https://www.mongodb.com/docs/

### 詞彙表

- **YOLO**：You Only Look Once，一種即時物件偵測演算法
- **人臉特徵向量**：Face Encoding，用於比對人臉的數學向量
- **信心度**：Confidence，模型對預測結果的確信程度（0-1）
- **YOLO 類別 ID**：Class ID，YOLO 模型訓練時定義的類別編號
- **購物車**：Shopping Cart，暫存使用者選購商品的清單
- **結帳**：Checkout，完成購物並記錄交易的流程

### 初始商品資料範例

```json
[
  {
    "name": "元翠茶",
    "price": 150,
    "yolo_class_id": 0,
    "yolo_class_name": "yuancui_tea",
    "created_at": "2025-10-30T03:25:19Z"
  },
  {
    "name": "分解茶",
    "price": 200,
    "yolo_class_id": 1,
    "yolo_class_name": "fenjie_tea",
    "created_at": "2025-10-30T03:25:19Z"
  }
]
```

---

**PRD 狀態**：Draft
**最後更新**：2025-10-30
**版本**：1.0
**作者**：Product Management Team
**核准者**：待定
